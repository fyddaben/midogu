var Util={targetEle:$("#klaus"),publicImg:"",tmpl:function(t,a){var o=document.getElementById(t).innerHTML,e=doT.template(o);return e(a)},oriToolBox:$(".J_tool_box").clone(),dataBase:{publicAttr:{imgHttp:""},panelArr:[]}},Box_tool=function(){var t=this;t.init()};Box_tool.prototype={constructor:Box_tool,init:function(){var t=this;t.endClick(),t.clickChooseLoc()},emitColorPicker:function(){$(".colorpicker-layout").colorpicker({parts:["map","bar","hsv","rgb","alpha","preview","swatches","footer"],alpha:!0,color:"#e53131",altField:"",altOnChange:!0,select:function(t,a){$(this).siblings(".color-btn").css("background-color","#"+a.formatted)}})},collapseEmit:function(){$(".panel-collapse").on("hidden.bs.collapse",function(){$(this).siblings(".panel-heading").find(".glyphicon").removeClass("glyphicon-chevron-down"),console.log("down")}).on("shown.bs.collapse",function(){$(this).siblings(".panel-heading").find(".glyphicon").addClass("glyphicon-chevron-down"),console.log("up")})},showBox:function(t){var a=this;a.resetForm();var o=$(".J_tool_box");Util.targetEle.hasClass("klaus")?($("#myTab").find("li").eq(0).hide(),$("#myTab").find("li").removeClass("active"),$("#myTab").find("li").eq(1).addClass("active"),$("#myTabContent").find(".tab-pane").eq(0).hide(),$("#myTabContent").find(".tab-pane").removeClass("active"),$("#myTabContent").find(".tab-pane").eq(1).addClass("active")):($("#myTab").find("li").eq(0).show(),$("#myTab").find("li").removeClass("active"),$("#myTab").find("li").eq(0).addClass("active"),$("#myTabContent").find(".tab-pane").eq(0).show(),$("#myTabContent").find(".tab-pane").removeClass("active"),$("#myTabContent").find(".tab-pane").eq(0).addClass("active"));var e=function(){o.css("left",t.x+"px").css("top",t.y+"px"),a.resetForm(),o.addClass("tool-show")};o.hasClass("tool-show")?(o.removeClass("tool-show"),setTimeout(e,300)):e()},endClick:function(){$_tool_box=$(".J_tool_box"),$(".J_tool_box").on("click",".J_cancel",function(){$_tool_box.removeClass("tool-show")}),$(".J_tool_box").on("click",".J_back_loctionlist >li",function(){var t=$(this).find("a").html();$(this).parent().siblings(".J_back_loctionlistbtn").html(t)});var t=this;$(".J_tool_box").on("click",".J_current_sure",function(){t.changeCurEle(),$_tool_box.removeClass("tool-show")}),$(".J_tool_box").on("click",".J_create_sure",function(){t.createEle(),$_tool_box.removeClass("tool-show")})},resetForm:function(){var t=this;t.clearForm();var a=Util.targetEle,o=a.attr("id"),e=null;return Util.dataBase.panelArr[o]?void(e=Util.dataBase.panelArr[o].css):!1},clearForm:function(){var t=this,a=$("#current-tmpl").html();$(".J_current_tab").html(a);var o=$("#create-tmpl").html();$(".J_create_tab").html(o),t.emitByUpdatePanel()},emitByUpdatePanel:function(){var t=this;t.emitColorPicker(),t.collapseEmit()},judgeUnit:function(t){var a="";return a=-1!=t.indexOf("%")?t:t+"px",(-1!=t.indexOf("top")||-1!=t.indexOf("left")||-1!=t.indexOf("bottom")||-1!=t.indexOf("right")|-1!=t.indexOf("center"))&&(a=t),a},judgeImgPath:function(t){var a=t;return-1!=a.indexOf("http://")?a=a:""!=a&&(a=Util.publicImg+a),a},createEle:function(){var t=this,a=$(".J_new_back_img").val();a=t.judgeImgPath(a);var o={left:{attr:"left",orival:$(".J_new_loc_x").val(),val:t.judgeUnit($(".J_new_loc_x").val())},top:{attr:"top",orival:$(".J_new_loc_y").val(),val:t.judgeUnit($(".J_new_loc_y").val())},width:{attr:"width",orival:$(".J_new_size_x").val(),val:t.judgeUnit($(".J_new_size_x").val())},height:{attr:"height",orival:$(".J_new_size_y").val(),val:t.judgeUnit($(".J_new_size_y").val())},back_pos_x:{attr:"background-position-x",orival:$(".J_new_back_pos_x").val(),val:t.judgeUnit($(".J_new_back_pos_x").val())},back_pos_y:{attr:"background-position-y",orival:$(".J_new_back_pos_y").val(),val:t.judgeUnit($(".J_new_back_pos_y").val())},back_repeat:{attr:"background-repeat",orival:$(".J_new_back_repeat").html(),val:$(".J_new_back_repeat").html()},back_color:{attr:"background-color",orival:$(".J_new_back_color").val(),val:"#"+$(".J_new_back_color").val()},back_img:{attr:"background-image",orival:$(".J_new_back_img").val(),val:"url("+a+")"},pos:{attr:"position",orival:"absolute",val:"absolute"}},e=Math.uuid(5),l={id:e,css:o,isOri:!1};Util.dataBase.panelArr[e]=l;var n=Util.tmpl("html-tmpl",l);Util.targetEle.append(n);var i=Util.tmpl("cssblock-tmpl",Util.dataBase.panelArr);$("#cssBlock").html(i)},changeCurEle:function(){var t=this,a=$(".J_current_back_img").val();-1!=a.indexOf("http://")?a=a:""!=a&&(a=Util.publicImg+a);var o={left:{attr:"left",orival:$(".J_current_loc_x").val(),val:t.judgeUnit($(".J_current_loc_x").val())},top:{attr:"top",orival:$(".J_current_loc_y").val(),val:t.judgeUnit($(".J_current_loc_y").val())},width:{attr:"width",orival:$(".J_current_size_x").val(),val:t.judgeUnit($(".J_current_size_x").val())},height:{attr:"height",orival:$(".J_current_size_y").val(),val:t.judgeUnit($(".J_current_size_y").val())},back_pos_x:{attr:"background-position-x",orival:$(".J_current_back_x").val(),val:t.judgeUnit($(".J_current_back_x").val())},back_pos_y:{attr:"background-position-y",orival:$(".J_current_back_y").val(),val:t.judgeUnit($(".J_current_back_y").val())},back_repeat:{attr:"background-repeat",orival:$(".J_current_back_repeat").html(),val:$(".J_current_back_repeat").html()},back_color:{attr:"background-color",orival:$(".J_current_back_color").val(),val:"#"+$(".J_current_back_color").val()},back_img:{attr:"background-image",orival:$(".J_current_back_img").val(),val:"url("+a+")"},pos:{attr:"position",orival:"absolute",val:"absolute"}},e=Math.uuid(5);Util.targetEle.hasClass("klaus")&&(e="klaus");var l={id:e,css:o,isOri:Util.targetEle.hasClass("klaus")};Util.dataBase.panelArr[e]=l;var n=Util.tmpl("html-tmpl",l);Util.targetEle.attr("id")?Util.targetEle.replaceWith(n):Util.targetEle.append(n)},clickChooseLoc:function(){$(".J_tool_box").on("click",".J_create_loc_choose > li",function(){var t=$(this).find("a").html(),a=$(this).attr("data-loc");$(this).parent().siblings(".J_create_loc_btn").attr("data-loc",a).html(t),"custom"==a&&$(this).parent().parent().siblings(".row").find(".J_new_loc_x").removeAttr("disabled"),"center"==a&&$(this).parent().parent().siblings(".row").find(".J_new_loc_x").val("").attr("disabled","disabled")})}};var Page_finger=function(){var t=this;t.init()};Page_finger.prototype={constructor:Page_finger,config:function(){var t=this;t.bt=new Box_tool,Util.oriToolBox=$(".J_tool_box").clone()},init:function(){var t=this;t.config(),t.clickRight()},clickRight:function(){var t=this;$("html,document").on("mousedown",function(){var a=window.event;if("0"!=a.button){var o=t.getMousePos(a);return Util.targetEle=$(a.target),t.showToolBox(o),!1}})},getMousePos:function(t){var a=t||window.event,o=document.documentElement.scrollLeft||document.body.scrollLeft,e=document.documentElement.scrollTop||document.body.scrollTop,l=a.pageX||a.clientX+o,n=a.pageY||a.clientY+e;return{x:l,y:n}},showToolBox:function(t){var a=this;a.bt.showBox(t)}},$(function(){new Page_finger});